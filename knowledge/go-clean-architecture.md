# Goクリーンアーキテクチャ

## 考え方のベース

- 豊富な機能を持つライブラリに依存しない

- テスト可能（ビジネスロジックがUI, DB, 外部サービス等の要素なしでテストできる）

- UIの独立（ビジネスロジックコードへの影響なしでUI変更可能）

- DBの独立（ビジネスロジックコードへの影響なしで使うDBを変更可能）

- 外部エージェントから独立（単体でサービス提供可能）

## レイヤー

### モデル（/model）

ビジネスモデル上で登場する全てのモデル（エンティティ）

他の全てのレイヤーから直接呼ばれる

構造体ベース（メソッドも持てる）

### リポジトリ（/repository）

DBやWebサービス、クラウドサービス、自システム内の他のサービスと直接やりとりするレイヤー

入出力チェックを行うが、ビジネスロジックは含まない（ある程度、汎用的な関数を提供する）

ORMを使う場合、同パッケージでラップする

★モデルとは別に構造体を用意（他のレイヤーからコールする際は、他のレイヤーにモデル→リポジトリ構造体への変換ロジックを持たせる）

### ユースケース（/usecase）

ビジネスロジックを定義

リポジトリレイヤーに依存

### デリバリ（/delivery）

外部へのプレゼンター

REST, gRPC等、形式はさまざま

ユースケースレイヤーに依存

## レイヤー間の通信

各レイヤーにインタフェースを定義

## レイヤー毎の検証

### モデル

依存なしのロジックのみなので単体テスト容易

### リポジトリ

基本的に結合テストで検証

モック「github.com/DATA-DOG/go-sqlmock 」を使い単体テストも可能






