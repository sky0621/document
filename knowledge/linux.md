# Linux

## 乱雑メモ

- システムコール・・・Linuxカーネルにデバイス操作を依頼

- /dev/null・・・読み込むと常に空、何かを書き込むとどこかに消えてしまうファイル

- 「ユーザAとしてアクセスする」＝「ユーザAの属性を持ったプロセスがアクセスする」

　※プロセスの属性としてのユーザのことをクレデンシャルと呼ぶ

- カーネルが持つストリームを番号と対応付け、プロセスにはその番号でストリームを指定させる

- ディレクトリに記録されるのは、ファイル１つの情報を表す構造体（＝ディレクトリエントリ）の列

- rm はファイルではなくファイル名を消すコマンド（※実体を表すファイル名が全てなくなった（＝リンクカウント０）時点でファイルの実体が削除される）

- ハードリンク（ln）はファイルの実体に新しい名前を付けて、その名前と実体を結びつけるコマンド　※現在では滅多に使われない

- シンボリックリンク（ln -s）はファイルの実体に新しい名前を付けて、もともとの名前に対して新しい名前を結びつけるコマンド

## C言語

- C言語における「文字」は単なる数値であり、「文字列」（char\*型）は数値の配列

### 文字コード

Javaや.NETはUTF-16、PerlやPython、Go、SwiftはUTF-8専用

俗に言う「文字コード」は、「符号化文字集合」と「エンコーディング」の混在ワード。

#### 符号化文字集合（CCS）

#### エンコーディング（CES）※EUC-JPやUTF-8は正確にはエンコーディングを指す

## 概念

- ファイルシステム

- プロセス

- ストリーム（＝バイト列が流れる通り道）

## ストリーム

- open ・・・ストリームを作る

- read ・・・ストリームからバイト列を読み込む

- write ・・・ストリームにバイト列を書き込む

- close ・・・用済みのストリームを始末する

## stdio（標準入出力ライブラリ）

カーネルレベルのストリームにAPIの層を追加して使いやすくしている。

例：１バイト単位の読み書きや、行単位の読み書き。数値や文字列のフォーマット出力。

### バッファリング

独自のバッファを用意し、（readであれば）「１バイトほしい」と言われたらバッファから１バイト取って返す。

システムコールは遅いため、ある程度バイト数をまとめて使うべきだが、stdioのAPIなら速度落とさず１バイト単位で読み込み可能。

## FHS

### /bin

OSのbootに必要な基本的なコマンド群

※「/usr/bin」はそれ以外の一般ユーザ向けのコマンド群

### /sbin

管理者用コマンド群

### /lib

各言語用のライブラリ

### /usr

複数のマシンで共有可能なファイル

##### /usr/src

システムで使っているコマンドのソースコード（※自作プログラムのソースコードは置かない！）

##### /usr/include

システムのヘッダファイル

##### /usr/share

CPUに依存しない、複数マシンで共有可能なファイル（※ドキュメント等）

##### /usr/local

各システムの管理者が責任をもって管理

#### /var

頻繁に書き換えられるファイルを置く

##### /var/log

主にサーバプロセスが書き込むログファイルを保存

##### /var/run

起動中のサーバプロセスのプロセスIDを保存（PIDファイル）

#### /etc

マシンごとの設定ファイルを置く

#### /dev

デバイスファイルを置く

#### /proc

プロセスファイルシステムがマウントされる

#### /sys (Linux 2.6～)

sysfsというファイルシステムがマウントされる

#### /boot

Linuxカーネルのプログラムが置かれている

## プロセス

### コンピュータの構造

バス（bus）を中心にCPUとメモリ（やHDD/SSD等）を仲立ちする

メモリは０か１（ビット）の列を記憶できるデバイス

CPUはメモリ上にあるプログラムに従って、メモリに記憶されているバイト列を変化させられるデバイス



