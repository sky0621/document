# 統合

## どんなﾒﾘｯﾄがあったとしてもDB統合は避ける！

・DB統合ではﾃｰﾌﾞﾙ構造の変更に外部ｻｰﾋﾞｽが耐えられない

・DB統合はﾃﾞｰﾀｽｷｰﾏ変更やｽﾄﾚｰｼﾞ変更(RDB->NoSQL等)に弱い

・ﾃﾞｰﾀの共有ではなく振る舞いを共有すべき

## ﾄﾚｰﾄﾞｵﾌを考慮の上、RESTを出発点とする！

・APIは技術非依存であるべき

・内部の実装詳細は隠す

★RPCについて★

　・ﾍﾟｲﾛｰﾄﾞのﾏｰｼｬﾙ/ｱﾝﾏｰｼｬﾙｺｽﾄを隠蔽しがち

　・誤解「ﾈｯﾄﾜｰｸには信頼性がある」

　・新ﾒｿｯﾄﾞ追加するとｸﾗｲｱﾝﾄｽﾀﾌﾞ再生成も必要

　・ｸﾗｲｱﾝﾄｽﾀﾌﾞ再生成を考慮すると、ｸﾗｲｱﾝﾄとｻｰﾊﾞをｾｯﾄでないとﾘﾘｰｽできない

　　　-> ｻｰﾊﾞ側にｽﾀﾌﾞのﾗｯﾊﾟｰ用意である程度吸収できる？
  
◆考察◆

・RPCは振る舞いﾍﾞｰｽで考えやすいが、RESTは(ﾘｿｰｽへのCRUDを意識しやすく)ﾘｿｰｽﾍﾞｰｽで考えがちになる

・HATEOAS採用でﾒｯｾｰｼﾞにﾘﾝｸを含められる

・1ﾏｲｸﾛｻｰﾋﾞｽ内では守るが全ｻｰﾋﾞｽにわたるDRYの違反は許容する

## ｵｰｹｽﾄﾚｰｼｮﾝよりｺﾚｵｸﾞﾗﾌｨを選ぶ！

・ﾘｸｴｽﾄ/ﾚｽﾎﾟﾝｽ方式は送信側が受信側に何をすべきかをﾘｸｴｽﾄする(非同期のｺｰﾙﾊﾞｯｸのｹｰｽもこのﾊﾟﾀｰﾝに含む)

・ｲﾍﾞﾝﾄﾍﾞｰｽ方式は「ある事態が起こった」ことを通知するのみ。何をすべきかは受信側が知っている前提。

  -> 各ﾏｲｸﾛｻｰﾋﾞｽはﾋﾞｼﾞﾈｽﾛｼﾞｯｸを内包し特定のｲﾍﾞﾝﾄが起きたら何をすべきかを知っている(実装している)
  
  -> ﾏｲｸﾛｻｰﾋﾞｽ間に要求(ﾘｸｴｽﾄ)は発生しない。ただ、ｲﾍﾞﾝﾄの通知があり、そのｲﾍﾞﾝﾄにﾘｱｸｼｮﾝすべきﾏｲｸﾛｻｰﾋﾞｽだけが処理を行う
  
  -> ｲﾍﾞﾝﾄに対して必要な全ての処理が完遂したかのﾁｪｯｸ、完遂していない場合のﾘｶﾊﾞﾘを担う機構が必要

## ﾎﾟｽﾃﾙの法則の理解、耐性のあるﾘｰﾀﾞｰ使用で破壊的変更を避ける！(ﾊﾞｰｼﾞｮﾝ不要化)

・送信するﾃﾞｰﾀに新しいﾌｨｰﾙﾄﾞを追加しても既存のｺﾝｼｭｰﾏに影響を与えないべき

・ｾﾏﾝﾃｨｯｸﾊﾞｰｼﾞﾖﾆﾝｸﾞ(Major/Miner/Patch)

## ﾕｰｻﾞｲﾝﾀﾌｪｰｽを合成ﾚｲﾔと考える！

・必要な機能ごとにWebAPIが分かれていると、1ﾍﾟｰｼﾞ表示のために複数API通信が必要＝通信負荷とUIの統一に課題

　-> UI統一はﾘﾋﾞﾝｸﾞｽﾀｲﾙｶﾞｲﾄﾞの用意(HTMLｺﾝﾎﾟｰﾈﾝﾄ化)で対応
  
  -> APIｹﾞｰﾄｳｪｲ…複数のWebAPI呼び出しをﾊﾞｯｸｴﾝﾄﾞで集約

＝ﾓﾉﾘｼｯｸｹﾞｰﾄｳｪｲ化の懸念

　-> BFF
  
  -> UI部品合成…ｻｰﾋﾞｽにUIの部分を直接提供させる。小さなｳｨｼﾞｪｯﾄﾀｲﾌﾟのｹｰｽと一連のUI部分を組み合わせるｼｯｸﾀｲﾌﾟがある
  
  -> Backends for Frontends…特定UI専念ﾁｰﾑがそのｻｰﾊﾞ側ｺﾝﾎﾟｰﾈﾝﾄも対処

※API認証/認可はUIとBFFの間に配置

※扱うべきｻｰﾋﾞｽの集約にのみ専念しﾛｼﾞｯｸは含ませない
